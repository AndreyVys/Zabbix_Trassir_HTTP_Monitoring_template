<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.4</version>
    <date>2021-12-15T13:26:41Z</date>
    <groups>
        <group>
            <uuid>fee27259157b47648bdfc176c661f51a</uuid>
            <name>Trassir</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>bf27090b71d745ebbf3556df7942345b</uuid>
            <template>Trassir_HTTP</template>
            <name>Trassir_HTTP</name>
            <groups>
                <group>
                    <name>Trassir</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>26f4f812db954a84a09545090a2fa286</uuid>
                    <name>trassir.automation</name>
                    <type>HTTP_AGENT</type>
                    <key>automation</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.automation</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>4f8fb53e077b4ab0a9f7f03c828d9a2f</uuid>
                    <name>trassir.channels_online</name>
                    <type>HTTP_AGENT</type>
                    <key>channels_online</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.channels_online</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>5fd98666d09148b2a15be2a351f60b0b</uuid>
                    <name>trassir.channels_total</name>
                    <type>HTTP_AGENT</type>
                    <key>channels_total</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.channels_total</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>8876337cc0844f03bc2b04fce682da04</uuid>
                    <name>trassir.cpu_load</name>
                    <type>HTTP_AGENT</type>
                    <key>cpu_load</key>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.cpu_load</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                    <triggers>
                        <trigger>
                            <uuid>626a89de45164e299b0f547f38a4ea83</uuid>
                            <expression>min(/Trassir_HTTP/cpu_load,5m)&gt;{$CPU.UTIL.CRIT}</expression>
                            <name>Trassir: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)</name>
                            <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <description>CPU utilization is too high. The system might be slow to respond.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>7fa0f1f1daa347a6a6488d86ec845671</uuid>
                    <name>trassir.database</name>
                    <type>HTTP_AGENT</type>
                    <key>database</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.database</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                    <triggers>
                        <trigger>
                            <uuid>4dc1c7c0af8c4276ae770a85207d36d9</uuid>
                            <expression>last(/Trassir_HTTP/database,#1)&lt;&gt;1</expression>
                            <name>Trassir: Database is not OK</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>8a9be93fbd444feeb7a8568cb1bce804</uuid>
                    <name>trassir.disks</name>
                    <type>HTTP_AGENT</type>
                    <key>disks</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.disks</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                    <triggers>
                        <trigger>
                            <uuid>de156cf49a384496a461f26521b2adc8</uuid>
                            <expression>last(/Trassir_HTTP/disks,#1)&lt;&gt;1</expression>
                            <name>Trassir: Disks is not OK</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>c88e5b65220541929878dec5f6c3759c</uuid>
                    <name>trassir.disks_stat_main_days</name>
                    <type>HTTP_AGENT</type>
                    <key>disks_stat_main_days</key>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.disks_stat_main_days</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>44c90c7d4cd84d979453dc5e21f85136</uuid>
                    <name>trassir.disks_stat_priv_days</name>
                    <type>HTTP_AGENT</type>
                    <key>disks_stat_priv_days</key>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.disks_stat_priv_days</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>934a18181d1c44d5b023ef2be301b8f4</uuid>
                    <name>trassir.disks_stat_subs_days</name>
                    <type>HTTP_AGENT</type>
                    <key>disks_stat_subs_days</key>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.disks_stat_subs_days</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>dbeb071c19c5453e81707b4c337a93da</uuid>
                    <name>trassir.network</name>
                    <type>HTTP_AGENT</type>
                    <key>network</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.network</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <uuid>c7248c782c5e49a08a5c073a621239f6</uuid>
                    <name>trassir.success</name>
                    <type>HTTP_AGENT</type>
                    <key>success</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.success</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                    <triggers>
                        <trigger>
                            <uuid>faa6495457664639aa3d983cebedaae8</uuid>
                            <expression>last(/Trassir_HTTP/success,#1)=0</expression>
                            <name>Trassir: Cannot read data</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>4872506f9d66447490fadb8e0fa04ef9</uuid>
                    <name>trassir.uptime</name>
                    <type>HTTP_AGENT</type>
                    <key>uptime</key>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>[^*]+?}</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.uptime</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.CONN}:8080/health</url>
                    <query_fields>
                        <query_field>
                            <name>password</name>
                            <value>{$PASSWORD}</value>
                        </query_field>
                    </query_fields>
                    <triggers>
                        <trigger>
                            <uuid>7df00e981aa44dbdaa363e6330cfeebd</uuid>
                            <expression>last(/Trassir_HTTP/uptime,#1)&lt;600</expression>
                            <name>Trassir server uptime &lt; 10m</name>
                            <opdata>Server uptime: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <httptests>
                <httptest>
                    <uuid>bd4eb62949d74a2a9a5e9ac7d9b70aef</uuid>
                    <name>Trassir Availability</name>
                    <steps>
                        <step>
                            <name>trassir</name>
                            <url>https://{HOST.CONN}:8080/health</url>
                        </step>
                    </steps>
                </httptest>
            </httptests>
            <macros>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>100</value>
                </macro>
                <macro>
                    <macro>{$PASSWORD}</macro>
                    <value></value>
                </macro>
            </macros>
        </template>
    </templates>
    <triggers>
        <trigger>
            <uuid>19b3521784e745f1ad533d32ce524d69</uuid>
            <expression>last(/Trassir_HTTP/channels_online,#1)&lt;&gt;last(/Trassir_HTTP/channels_total,#1)</expression>
            <name>Trassir: Cameras or channels is not OK (active: {ITEM.LASTVALUE1} /  total: {ITEM.LASTVALUE2} )</name>
            <opdata>online: {ITEM.LASTVALUE1} / total: {ITEM.LASTVALUE2}</opdata>
            <priority>HIGH</priority>
        </trigger>
        <trigger>
            <uuid>bea13f15ebe5456a89b554f0563aa607</uuid>
            <expression>last(/Trassir_HTTP/web.test.fail[Trassir Availability],#1)&lt;&gt;0</expression>
            <name>Trassir server unavailable</name>
            <priority>HIGH</priority>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <uuid>1b7f57b92ffa43958d3402c5b84fa7fa</uuid>
            <name>cpu_usage</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Trassir_HTTP</host>
                        <key>cpu_load</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>ac1a8f91c63543c6a63d260f0b7f5320</uuid>
            <name>Uptime</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>Trassir_HTTP</host>
                        <key>uptime</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
